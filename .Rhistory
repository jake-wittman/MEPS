overall = 'Total',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
)) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 1) #%>%
?fct_relevel
age_adjusted_preventive %>%
filter(label == 'Three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Total',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
),
strata = fct_relevel(strata, 'High Income', 'Middle income', 'Low income', 'Poor/Negative')) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 1) #%>%
warnings()
age_adjusted_preventive %>%
filter(label == 'Three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100,
strata = as.factor(strata)) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Total',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
),
strata = fct_relevel(strata, 'High Income', 'Middle income', 'Low income', 'Poor/Negative')) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 1) #%>%
age_adjusted_preventive %>%
filter(label == 'Three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata))
age_adjusted_preventive %>%
filter(label == 'Three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Total',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
),
strata = fct_relevel(strata, 'High Income', 'Middle income', 'Low income', 'Poor/Negative')) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 1) #%>%
warnings()
age_adjusted_preventive %>%
filter(label == 'Three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Total',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
),
strata = fct_relevel(strata, "-",
'18 to 44', '45 to 64', '65 to 74', '75+',
'Greater than high school', 'High school', 'Less than high school',
'Asian/Not Hispanic', 'Black/Not Hispanic', 'Hispanic', 'White/Not Hispanic',
'Female', 'Male',
'Any private', 'Public only', 'Uninsured',
'High Income', 'Middle income', 'Low income', 'Poor/Negative')) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 1) #%>%
warnings()
age_adjusted_preventive %>%
filter(label == 'Three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Total',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
),
strata = fct_relevel(strata, "-",
'18 to 44', '45 to 64', '65 to 74', '75+',
'Greater than high school', 'High school', 'Less than high school',
'Asian/Not Hispanic', 'Black/Not Hispanic', 'Hispanic', 'White/Not Hispanic',
'Female', 'Male',
'Any private', 'Public only', 'Uninsured',
'High income', 'Middle income', 'Low income', 'Poor/Negative')) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 1) #%>%
?fct_relevel
age_adjusted_preventive %>%
filter(label == 'Three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Total',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
),
strata = fct_relevel(strata, "-",
'18 to 44', '45 to 64', '65 to 74', '75+',
'Greater than high school', 'High school', 'Less than high school',
'Asian/Not Hispanic', 'Black/Not Hispanic', 'Hispanic', 'White/Not Hispanic',
'Female', 'Male',
'Any private', 'Public only', 'Uninsured',
'High income', 'Middle income', 'Low income', 'Poor/Negative')) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 2) #%>%
age_adjusted_preventive %>%
filter(label == 'Three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Total',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
),
strata = fct_relevel(strata, "-",
'18 to 44', '45 to 64', '65 to 74', '75+',
'Greater than high school', 'High school', 'Less than high school',
'Asian/Not Hispanic', 'Black/Not Hispanic', 'Hispanic', 'White/Not Hispanic',
'Female', 'Male',
'Any private', 'Public only', 'Uninsured',
'High income', 'Middle income', 'Low income', 'Poor/Negative')) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 2) -> v#%>%
str(v)
v$_data
v$`_data`
v$`_data` %>% View()
v$`_data` <- v$`_data`[c(1:18, 20, 19, 21), ]
v
preventive_practice_table <- age_adjusted_preventive %>%
filter(label == 'Three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Total',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
)) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 2)
tar_load(age_adjusted_preventive)
preventive_practice_table <- age_adjusted_preventive %>%
filter(label == 'Three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Total',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
)) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 2)
preventive_practice_table$`_data` <- preventive_practice_table$`_data`[c(1:18, 20, 19, 21), ]
preventive_practice_table %>%
gtsave('preventive_practices.docx')
tar_load(age_adjusted_preventive)
preventive_practice_table <- age_adjusted_preventive %>%
filter(label == 'Three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Total',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
)) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 1)
preventive_practice_table$`_data` <- preventive_practice_table$`_data`[c(1:18, 20, 19, 21), ]
preventive_practice_table %>%
gtsave('preventive_practices.docx')
preventive_practice_table <- age_adjusted_preventive %>%
filter(label == 'At least three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Overall',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
)) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 1)
preventive_practice_table
tar_load(age_adjusted_preventive)
preventive_practice_table <- age_adjusted_preventive %>%
filter(label == 'At least three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Overall',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
)) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 1)
preventive_practice_table$`_data` <- preventive_practice_table$`_data`[c(1:18, 20, 19, 21), ]
preventive_practice_table %>%
gtsave('preventive_practices.docx')
tar_load(age_adjusted_preventive)
preventive_practice_table <- age_adjusted_preventive %>%
filter(label == 'At least three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Overall',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
)) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 1)
preventive_practice_table$`_data` <- preventive_practice_table$`_data`[c(1:18, 20, 19, 21), ]
preventive_practice_table %>%
gtsave('preventive_practices.docx')
source("C:/R_Rstudio/Projects/MEPS/scripts/functions.R")
job::job({targets::tar_make(age_adjusted_preventive)})
tar_load(age_adjusted_preventive)
preventive_practice_table <- age_adjusted_preventive %>%
filter(label == 'At least three preventive practices followed') %>%
mutate(age_adjusted_prop = age_adjusted_prop * 100) %>%
pivot_wider(
id_cols = c(stratifier, variable, label, strata),
names_from = year,
values_from = age_adjusted_prop
) %>%
filter(strata %!in% c('Not available', 'Other Race/Not Hispanic')) %>%
mutate(stratifier = factor(stratifier,
c('overall', 'age', 'sex', 'race', 'edu', 'insurance', 'poverty')),
strata = case_when(strata == 'stat_0' ~ '-',
strata == 'Greater than HS' ~ 'Greater than high school',
TRUE ~ strata)) %>%
mutate(strata = as.factor(strata)) %>%
mutate(stratifier = recode_factor(
stratifier,
overall = 'Overall',
age = 'Age',
sex = 'Sex',
race = 'Race/Ethnicity',
edu = 'Highest degree earned',
insurance = 'Insurance coverage',
poverty = 'Poverty level'
)) %>%
group_by(stratifier) %>%
select(stratifier, strata, `2008`:`2020`) %>%
gt() %>%
fmt_number(columns = `2008`:`2020`, decimals = 1)
preventive_practice_table$`_data` <- preventive_practice_table$`_data`[c(1:18, 20, 19, 21), ]
preventive_practice_table
renv::restore()
library(targets)
tar_visnetwork()
tar_visnetwork90
tar_visnetwork()
tar_make_clustermq(c(age_adjusted_preventive, stats_table), workers = 28)
renv::install('clustermq')
sessionInfo()
renv::install('future')
renv::install('future.callr')
tar_make_future(c(age_adjusted_preventive, stats_table), workers = 28)
tar_make_future(c(age_adjusted_preventive, stats_table), workers = 14)
renv::install('arrow')
tar_make_future(c(age_adjusted_preventive, stats_table), workers = 14)
warnings()
tar_make_future( workers = 20)
